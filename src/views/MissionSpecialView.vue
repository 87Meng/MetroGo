<template>
  <Navbar_V1 />
  <div class="mission-body" ref="container">
    <div class="mission-menu">
      <div class="menu-and-box">
        <!-- <button @click="isPopupOpen = true" class="menu-button">
          <span class="menu-icon">&#9776;</span>
          <span>選單</span>
        </button> -->
        <button @click="openModal('gameRules')" class="menu-button">
          <div class="menu-icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="45"
              height="45"
              viewBox="0 0 45 45"
              fill="none"
            >
              <path
                d="M22.5 41.25C12.1444 41.25 3.75 32.8556 3.75 22.5C3.75 12.1444 12.1444 3.75 22.5 3.75C32.8556 3.75 41.25 12.1444 41.25 22.5C41.25 32.8556 32.8556 41.25 22.5 41.25ZM20.625 28.125V31.875H24.375V28.125H20.625ZM24.375 25.0406C25.8819 24.5865 27.1755 23.6062 28.0203 22.2783C28.8651 20.9504 29.2048 19.3632 28.9776 17.8059C28.7504 16.2485 27.9715 14.8246 26.7825 13.7934C25.5936 12.7621 24.0738 12.1923 22.5 12.1875C20.9828 12.187 19.5122 12.7123 18.3386 13.6739C17.1651 14.6356 16.3609 15.9741 16.0631 17.4619L19.7419 18.1988C19.8463 17.6764 20.0968 17.1945 20.4644 16.809C20.832 16.4236 21.3015 16.1504 21.8183 16.0213C22.3351 15.8923 22.8779 15.9126 23.3835 16.0799C23.8892 16.2473 24.337 16.5548 24.6747 16.9667C25.0124 17.3786 25.2262 17.8779 25.2913 18.4066C25.3563 18.9352 25.2699 19.4715 25.0421 19.953C24.8142 20.4344 24.4544 20.8413 24.0044 21.1262C23.5543 21.4112 23.0326 21.5625 22.5 21.5625C22.0027 21.5625 21.5258 21.76 21.1742 22.1117C20.8225 22.4633 20.625 22.9402 20.625 23.4375V26.25H24.375V25.0406Z"
                fill="white"
              />
            </svg>
          </div>
          <div class="menu-text">玩法說明</div>
        </button>
        <div class="money_box">
          <div class="icon">
            <svg
              class="vector"
              width="32"
              height="33"
              viewBox="0 0 32 33"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M24 2.64381C26.4323 4.0481 28.4521 6.06791 29.8564 8.50022C31.2607 10.9325 32 13.6916 32 16.5002C32 19.3088 31.2607 22.0679 29.8563 24.5002C28.452 26.9325 26.4322 28.9523 23.9998 30.3565C21.5675 31.7608 18.8084 32.5 15.9997 32.5C13.1911 32.5 10.432 31.7606 7.99974 30.3563C5.56744 28.9519 3.54766 26.9321 2.14342 24.4997C0.739168 22.0674 -7.13435e-05 19.3083 5.16424e-09 16.4997L0.00800019 15.9813C0.0976051 13.2181 0.901676 10.5253 2.34182 8.16536C3.78197 5.80543 5.80905 3.85893 8.22543 2.51563C10.6418 1.17232 13.365 0.478063 16.1296 0.500528C18.8942 0.522994 21.6058 1.26142 24 2.64381ZM16 6.89978C15.5757 6.89978 15.1687 7.06835 14.8686 7.36841C14.5686 7.66846 14.4 8.07543 14.4 8.49977C13.127 8.49977 11.9061 9.00548 11.0059 9.90565C10.1057 10.8058 9.6 12.0267 9.6 13.2997C9.6 14.5728 10.1057 15.7937 11.0059 16.6938C11.9061 17.594 13.127 18.0997 14.4 18.0997V21.2997C14.1346 21.3144 13.8697 21.264 13.6283 21.1531C13.3868 21.0421 13.1761 20.8738 13.0144 20.6629L12.9056 20.5013C12.6867 20.1482 12.3391 19.8942 11.9362 19.7928C11.5334 19.6915 11.1069 19.7507 10.747 19.9581C10.3871 20.1655 10.1219 20.5048 10.0076 20.9041C9.89326 21.3035 9.93874 21.7316 10.1344 22.0981C10.5428 22.8063 11.1253 23.3985 11.8267 23.8185C12.5282 24.2386 13.3252 24.4725 14.1424 24.4981H14.4C14.3997 24.8902 14.5434 25.2688 14.8038 25.562C15.0643 25.8552 15.4233 26.0426 15.8128 26.0884L16 26.0996C16.4243 26.0996 16.8313 25.9311 17.1314 25.631C17.4314 25.331 17.6 24.924 17.6 24.4997L17.8816 24.4917C19.129 24.4196 20.2991 23.8639 21.1433 22.9428C21.9875 22.0217 22.4392 20.8077 22.4026 19.5588C22.3659 18.3099 21.8437 17.1245 20.9469 16.2545C20.0501 15.3846 18.8494 14.8985 17.6 14.8997V11.6997C18.1728 11.6805 18.6736 11.9237 18.9856 12.3365L19.0944 12.4981C19.3133 12.8512 19.6609 13.1052 20.0638 13.2066C20.4666 13.308 20.8931 13.2487 21.253 13.0413C21.6129 12.8339 21.8781 12.4947 21.9924 12.0953C22.1067 11.6959 22.0613 11.2678 21.8656 10.9014C21.4574 10.1928 20.875 9.60027 20.1735 9.17997C19.4721 8.75967 18.6749 8.52553 17.8576 8.49977H17.6C17.6 8.07543 17.4314 7.66846 17.1314 7.36841C16.8313 7.06835 16.4243 6.89978 16 6.89978ZM17.6 18.0997C18.0243 18.0997 18.4313 18.2683 18.7314 18.5683C19.0314 18.8684 19.2 19.2753 19.2 19.6997C19.2 20.124 19.0314 20.531 18.7314 20.831C18.4313 21.1311 18.0243 21.2997 17.6 21.2997V18.0997ZM14.4 11.6997V14.8997C13.9757 14.8997 13.5687 14.7312 13.2686 14.4311C12.9686 14.131 12.8 13.7241 12.8 13.2997C12.8 12.8754 12.9686 12.4684 13.2686 12.1684C13.5687 11.8683 13.9757 11.6997 14.4 11.6997Z"
                fill="#FCD34D"
              />
            </svg>
          </div>
          <div class="money title1 bold lineH_28px">{{ userPoints }}</div>
        </div>
      </div>
      <div class="line_select_btns" ref="line_select_btns">
        <RouterLink to="red" class="router_link" @click="">
          <button class="red">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="52"
              height="52"
              viewBox="0 0 52 52"
              fill="none"
            >
              <g clip-path="url(#clip0_3824_7434)">
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M45.5 13.0001C45.5 10.2418 44.4043 7.59657 42.4539 5.64619C40.5035 3.69581 37.8583 2.6001 35.1 2.6001H16.9C14.1417 2.6001 11.4965 3.69581 9.54609 5.64619C7.59571 7.59657 6.5 10.2418 6.5 13.0001V31.1741C6.50007 33.3936 7.21024 35.555 8.52665 37.342C9.84306 39.129 11.6967 40.448 13.8164 41.1061C17.8689 42.3628 21.9301 42.992 26 42.9937C30.0699 42.9937 34.1311 42.3636 38.1836 41.1035C40.3033 40.4454 42.1569 39.1264 43.4734 37.3394C44.7898 35.5524 45.4999 33.391 45.5 31.1715V13.0001ZM11.7 31.1741V13.0001C11.7 11.621 12.2479 10.2983 13.223 9.32314C14.1982 8.34795 15.5209 7.8001 16.9 7.8001H35.1C36.4791 7.8001 37.8018 8.34795 38.777 9.32314C39.7521 10.2983 40.3 11.621 40.3 13.0001V31.1741C40.3 32.2839 39.9449 33.3645 39.2867 34.258C38.6285 35.1515 37.7017 35.811 36.6418 36.1401C33.1988 37.2275 29.6106 37.785 26 37.7937C22.4623 37.7937 18.915 37.2416 15.3582 36.1375C14.2988 35.8086 13.3723 35.1495 12.7141 34.2565C12.0559 33.3635 11.7006 32.2834 11.7 31.1741Z"
                  fill="white"
                />
                <path
                  d="M20.7996 31.2C20.7996 32.2344 20.3887 33.2264 19.6573 33.9578C18.9259 34.6892 17.9339 35.1 16.8996 35.1C15.8652 35.1 14.8733 34.6892 14.1419 33.9578C13.4105 33.2264 12.9996 32.2344 12.9996 31.2C12.9996 30.1657 13.4105 29.1737 14.1419 28.4423C14.8733 27.7109 15.8652 27.3 16.8996 27.3C17.9339 27.3 18.9259 27.7109 19.6573 28.4423C20.3887 29.1737 20.7996 30.1657 20.7996 31.2ZM38.9996 31.2C38.9996 32.2344 38.5887 33.2264 37.8573 33.9578C37.1259 34.6892 36.1339 35.1 35.0996 35.1C34.0652 35.1 33.0733 34.6892 32.3419 33.9578C31.6105 33.2264 31.1996 32.2344 31.1996 31.2C31.1996 30.1657 31.6105 29.1737 32.3419 28.4423C33.0733 27.7109 34.0652 27.3 35.0996 27.3C36.1339 27.3 37.1259 27.7109 37.8573 28.4423C38.5887 29.1737 38.9996 30.1657 38.9996 31.2ZM11.9102 39.3822C12.0403 39.0633 12.2325 38.7735 12.4757 38.5295C12.7188 38.2854 13.008 38.0922 13.3264 37.9609C13.6448 37.8296 13.9862 37.7629 14.3307 37.7646C14.6751 37.7664 15.0158 37.8366 15.3329 37.9711C15.6499 38.1056 15.9372 38.3018 16.1778 38.5482C16.4184 38.7947 16.6077 39.0865 16.7346 39.4067C16.8615 39.7269 16.9235 40.0692 16.917 40.4136C16.9105 40.758 16.8357 41.0976 16.6968 41.4128L12.8618 50.4478C12.7363 50.7732 12.5466 51.07 12.3041 51.3206C12.0616 51.5712 11.7711 51.7704 11.45 51.9064C11.1289 52.0424 10.7837 52.1124 10.4349 52.1123C10.0862 52.1121 9.74108 52.0419 9.42007 51.9056C9.09907 51.7694 8.80875 51.5699 8.5664 51.3192C8.32405 51.0684 8.13462 50.7715 8.00938 50.446C7.88415 50.1205 7.82566 49.7732 7.83741 49.4247C7.84916 49.0761 7.93091 48.7335 8.07778 48.4172L11.9102 39.3822ZM40.2164 38.0978C40.0979 37.7776 39.9175 37.4838 39.6855 37.2332C39.4535 36.9827 39.1744 36.7803 38.8641 36.6376C38.5539 36.4949 38.2186 36.4147 37.8773 36.4016C37.5361 36.3885 37.1956 36.4428 36.8754 36.5612C36.5551 36.6797 36.2613 36.8601 36.0108 37.0921C35.7602 37.3242 35.5578 37.6033 35.4151 37.9135C35.2725 38.2237 35.1923 38.5591 35.1792 38.9003C35.1661 39.2415 35.2203 39.582 35.3388 39.9022L39.1608 50.2242C39.2793 50.5445 39.4597 50.8383 39.6917 51.0889C39.9237 51.3394 40.2028 51.5418 40.513 51.6845C40.8233 51.8272 41.1586 51.9074 41.4998 51.9205C41.841 51.9336 42.1815 51.8793 42.5018 51.7609C42.822 51.6424 43.1158 51.462 43.3664 51.2299C43.6169 50.9979 43.8193 50.7188 43.962 50.4086C44.1047 50.0983 44.1849 49.763 44.198 49.4218C44.2111 49.0806 44.1569 48.7401 44.0384 48.4198L40.2164 38.0978Z"
                  fill="white"
                />
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M39 15.6001C39 13.8762 38.3152 12.2229 37.0962 11.0039C35.8772 9.78492 34.2239 9.1001 32.5 9.1001H19.5C17.7761 9.1001 16.1228 9.78492 14.9038 11.0039C13.6848 12.2229 13 13.8762 13 15.6001V19.5911C13.0005 21.1235 13.5424 22.6065 14.53 23.7782C15.5176 24.9499 16.8874 25.735 18.3976 25.9949C20.93 26.4317 23.4641 26.6501 26 26.6501C28.5359 26.6501 31.07 26.4317 33.6024 25.9949C35.1126 25.735 36.4824 24.9499 37.47 23.7782C38.4576 22.6065 38.9995 21.1235 39 19.5911V15.6001ZM18.2 19.5911V15.6001C18.2 15.2553 18.337 14.9247 18.5808 14.6809C18.8246 14.4371 19.1552 14.3001 19.5 14.3001H32.5C32.8448 14.3001 33.1754 14.4371 33.4192 14.6809C33.663 14.9247 33.8 15.2553 33.8 15.6001V19.5911C33.7996 19.8972 33.6911 20.1934 33.4937 20.4274C33.2963 20.6614 33.0227 20.8183 32.721 20.8703C30.4763 21.2568 28.236 21.4501 26 21.4501C23.764 21.4501 21.5237 21.2568 19.279 20.8703C18.9773 20.8183 18.7037 20.6614 18.5063 20.4274C18.3089 20.1934 18.2004 19.8972 18.2 19.5911Z"
                  fill="white"
                />
                <path d="M12.3496 47.45V43.55H39.6522V47.45H12.3496Z" fill="white" />
              </g>
              <defs>
                <clipPath id="clip0_3824_7434">
                  <rect width="52" height="52" fill="white" />
                </clipPath>
              </defs>
            </svg>
          </button>
        </RouterLink>
        <RouterLink to="green" class="router_link">
          <button class="green">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="52"
              height="52"
              viewBox="0 0 52 52"
              fill="none"
            >
              <g clip-path="url(#clip0_3824_7434)">
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M45.5 13.0001C45.5 10.2418 44.4043 7.59657 42.4539 5.64619C40.5035 3.69581 37.8583 2.6001 35.1 2.6001H16.9C14.1417 2.6001 11.4965 3.69581 9.54609 5.64619C7.59571 7.59657 6.5 10.2418 6.5 13.0001V31.1741C6.50007 33.3936 7.21024 35.555 8.52665 37.342C9.84306 39.129 11.6967 40.448 13.8164 41.1061C17.8689 42.3628 21.9301 42.992 26 42.9937C30.0699 42.9937 34.1311 42.3636 38.1836 41.1035C40.3033 40.4454 42.1569 39.1264 43.4734 37.3394C44.7898 35.5524 45.4999 33.391 45.5 31.1715V13.0001ZM11.7 31.1741V13.0001C11.7 11.621 12.2479 10.2983 13.223 9.32314C14.1982 8.34795 15.5209 7.8001 16.9 7.8001H35.1C36.4791 7.8001 37.8018 8.34795 38.777 9.32314C39.7521 10.2983 40.3 11.621 40.3 13.0001V31.1741C40.3 32.2839 39.9449 33.3645 39.2867 34.258C38.6285 35.1515 37.7017 35.811 36.6418 36.1401C33.1988 37.2275 29.6106 37.785 26 37.7937C22.4623 37.7937 18.915 37.2416 15.3582 36.1375C14.2988 35.8086 13.3723 35.1495 12.7141 34.2565C12.0559 33.3635 11.7006 32.2834 11.7 31.1741Z"
                  fill="white"
                />
                <path
                  d="M20.7996 31.2C20.7996 32.2344 20.3887 33.2264 19.6573 33.9578C18.9259 34.6892 17.9339 35.1 16.8996 35.1C15.8652 35.1 14.8733 34.6892 14.1419 33.9578C13.4105 33.2264 12.9996 32.2344 12.9996 31.2C12.9996 30.1657 13.4105 29.1737 14.1419 28.4423C14.8733 27.7109 15.8652 27.3 16.8996 27.3C17.9339 27.3 18.9259 27.7109 19.6573 28.4423C20.3887 29.1737 20.7996 30.1657 20.7996 31.2ZM38.9996 31.2C38.9996 32.2344 38.5887 33.2264 37.8573 33.9578C37.1259 34.6892 36.1339 35.1 35.0996 35.1C34.0652 35.1 33.0733 34.6892 32.3419 33.9578C31.6105 33.2264 31.1996 32.2344 31.1996 31.2C31.1996 30.1657 31.6105 29.1737 32.3419 28.4423C33.0733 27.7109 34.0652 27.3 35.0996 27.3C36.1339 27.3 37.1259 27.7109 37.8573 28.4423C38.5887 29.1737 38.9996 30.1657 38.9996 31.2ZM11.9102 39.3822C12.0403 39.0633 12.2325 38.7735 12.4757 38.5295C12.7188 38.2854 13.008 38.0922 13.3264 37.9609C13.6448 37.8296 13.9862 37.7629 14.3307 37.7646C14.6751 37.7664 15.0158 37.8366 15.3329 37.9711C15.6499 38.1056 15.9372 38.3018 16.1778 38.5482C16.4184 38.7947 16.6077 39.0865 16.7346 39.4067C16.8615 39.7269 16.9235 40.0692 16.917 40.4136C16.9105 40.758 16.8357 41.0976 16.6968 41.4128L12.8618 50.4478C12.7363 50.7732 12.5466 51.07 12.3041 51.3206C12.0616 51.5712 11.7711 51.7704 11.45 51.9064C11.1289 52.0424 10.7837 52.1124 10.4349 52.1123C10.0862 52.1121 9.74108 52.0419 9.42007 51.9056C9.09907 51.7694 8.80875 51.5699 8.5664 51.3192C8.32405 51.0684 8.13462 50.7715 8.00938 50.446C7.88415 50.1205 7.82566 49.7732 7.83741 49.4247C7.84916 49.0761 7.93091 48.7335 8.07778 48.4172L11.9102 39.3822ZM40.2164 38.0978C40.0979 37.7776 39.9175 37.4838 39.6855 37.2332C39.4535 36.9827 39.1744 36.7803 38.8641 36.6376C38.5539 36.4949 38.2186 36.4147 37.8773 36.4016C37.5361 36.3885 37.1956 36.4428 36.8754 36.5612C36.5551 36.6797 36.2613 36.8601 36.0108 37.0921C35.7602 37.3242 35.5578 37.6033 35.4151 37.9135C35.2725 38.2237 35.1923 38.5591 35.1792 38.9003C35.1661 39.2415 35.2203 39.582 35.3388 39.9022L39.1608 50.2242C39.2793 50.5445 39.4597 50.8383 39.6917 51.0889C39.9237 51.3394 40.2028 51.5418 40.513 51.6845C40.8233 51.8272 41.1586 51.9074 41.4998 51.9205C41.841 51.9336 42.1815 51.8793 42.5018 51.7609C42.822 51.6424 43.1158 51.462 43.3664 51.2299C43.6169 50.9979 43.8193 50.7188 43.962 50.4086C44.1047 50.0983 44.1849 49.763 44.198 49.4218C44.2111 49.0806 44.1569 48.7401 44.0384 48.4198L40.2164 38.0978Z"
                  fill="white"
                />
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M39 15.6001C39 13.8762 38.3152 12.2229 37.0962 11.0039C35.8772 9.78492 34.2239 9.1001 32.5 9.1001H19.5C17.7761 9.1001 16.1228 9.78492 14.9038 11.0039C13.6848 12.2229 13 13.8762 13 15.6001V19.5911C13.0005 21.1235 13.5424 22.6065 14.53 23.7782C15.5176 24.9499 16.8874 25.735 18.3976 25.9949C20.93 26.4317 23.4641 26.6501 26 26.6501C28.5359 26.6501 31.07 26.4317 33.6024 25.9949C35.1126 25.735 36.4824 24.9499 37.47 23.7782C38.4576 22.6065 38.9995 21.1235 39 19.5911V15.6001ZM18.2 19.5911V15.6001C18.2 15.2553 18.337 14.9247 18.5808 14.6809C18.8246 14.4371 19.1552 14.3001 19.5 14.3001H32.5C32.8448 14.3001 33.1754 14.4371 33.4192 14.6809C33.663 14.9247 33.8 15.2553 33.8 15.6001V19.5911C33.7996 19.8972 33.6911 20.1934 33.4937 20.4274C33.2963 20.6614 33.0227 20.8183 32.721 20.8703C30.4763 21.2568 28.236 21.4501 26 21.4501C23.764 21.4501 21.5237 21.2568 19.279 20.8703C18.9773 20.8183 18.7037 20.6614 18.5063 20.4274C18.3089 20.1934 18.2004 19.8972 18.2 19.5911Z"
                  fill="white"
                />
                <path d="M12.3496 47.45V43.55H39.6522V47.45H12.3496Z" fill="white" />
              </g>
              <defs>
                <clipPath id="clip0_3824_7434">
                  <rect width="52" height="52" fill="white" />
                </clipPath>
              </defs>
            </svg>
          </button>
        </RouterLink>
        <RouterLink to="/special-mission/blue" class="router_link">
          <button class="blue">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="52"
              height="52"
              viewBox="0 0 52 52"
              fill="none"
            >
              <g clip-path="url(#clip0_3824_7434)">
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M45.5 13.0001C45.5 10.2418 44.4043 7.59657 42.4539 5.64619C40.5035 3.69581 37.8583 2.6001 35.1 2.6001H16.9C14.1417 2.6001 11.4965 3.69581 9.54609 5.64619C7.59571 7.59657 6.5 10.2418 6.5 13.0001V31.1741C6.50007 33.3936 7.21024 35.555 8.52665 37.342C9.84306 39.129 11.6967 40.448 13.8164 41.1061C17.8689 42.3628 21.9301 42.992 26 42.9937C30.0699 42.9937 34.1311 42.3636 38.1836 41.1035C40.3033 40.4454 42.1569 39.1264 43.4734 37.3394C44.7898 35.5524 45.4999 33.391 45.5 31.1715V13.0001ZM11.7 31.1741V13.0001C11.7 11.621 12.2479 10.2983 13.223 9.32314C14.1982 8.34795 15.5209 7.8001 16.9 7.8001H35.1C36.4791 7.8001 37.8018 8.34795 38.777 9.32314C39.7521 10.2983 40.3 11.621 40.3 13.0001V31.1741C40.3 32.2839 39.9449 33.3645 39.2867 34.258C38.6285 35.1515 37.7017 35.811 36.6418 36.1401C33.1988 37.2275 29.6106 37.785 26 37.7937C22.4623 37.7937 18.915 37.2416 15.3582 36.1375C14.2988 35.8086 13.3723 35.1495 12.7141 34.2565C12.0559 33.3635 11.7006 32.2834 11.7 31.1741Z"
                  fill="white"
                />
                <path
                  d="M20.7996 31.2C20.7996 32.2344 20.3887 33.2264 19.6573 33.9578C18.9259 34.6892 17.9339 35.1 16.8996 35.1C15.8652 35.1 14.8733 34.6892 14.1419 33.9578C13.4105 33.2264 12.9996 32.2344 12.9996 31.2C12.9996 30.1657 13.4105 29.1737 14.1419 28.4423C14.8733 27.7109 15.8652 27.3 16.8996 27.3C17.9339 27.3 18.9259 27.7109 19.6573 28.4423C20.3887 29.1737 20.7996 30.1657 20.7996 31.2ZM38.9996 31.2C38.9996 32.2344 38.5887 33.2264 37.8573 33.9578C37.1259 34.6892 36.1339 35.1 35.0996 35.1C34.0652 35.1 33.0733 34.6892 32.3419 33.9578C31.6105 33.2264 31.1996 32.2344 31.1996 31.2C31.1996 30.1657 31.6105 29.1737 32.3419 28.4423C33.0733 27.7109 34.0652 27.3 35.0996 27.3C36.1339 27.3 37.1259 27.7109 37.8573 28.4423C38.5887 29.1737 38.9996 30.1657 38.9996 31.2ZM11.9102 39.3822C12.0403 39.0633 12.2325 38.7735 12.4757 38.5295C12.7188 38.2854 13.008 38.0922 13.3264 37.9609C13.6448 37.8296 13.9862 37.7629 14.3307 37.7646C14.6751 37.7664 15.0158 37.8366 15.3329 37.9711C15.6499 38.1056 15.9372 38.3018 16.1778 38.5482C16.4184 38.7947 16.6077 39.0865 16.7346 39.4067C16.8615 39.7269 16.9235 40.0692 16.917 40.4136C16.9105 40.758 16.8357 41.0976 16.6968 41.4128L12.8618 50.4478C12.7363 50.7732 12.5466 51.07 12.3041 51.3206C12.0616 51.5712 11.7711 51.7704 11.45 51.9064C11.1289 52.0424 10.7837 52.1124 10.4349 52.1123C10.0862 52.1121 9.74108 52.0419 9.42007 51.9056C9.09907 51.7694 8.80875 51.5699 8.5664 51.3192C8.32405 51.0684 8.13462 50.7715 8.00938 50.446C7.88415 50.1205 7.82566 49.7732 7.83741 49.4247C7.84916 49.0761 7.93091 48.7335 8.07778 48.4172L11.9102 39.3822ZM40.2164 38.0978C40.0979 37.7776 39.9175 37.4838 39.6855 37.2332C39.4535 36.9827 39.1744 36.7803 38.8641 36.6376C38.5539 36.4949 38.2186 36.4147 37.8773 36.4016C37.5361 36.3885 37.1956 36.4428 36.8754 36.5612C36.5551 36.6797 36.2613 36.8601 36.0108 37.0921C35.7602 37.3242 35.5578 37.6033 35.4151 37.9135C35.2725 38.2237 35.1923 38.5591 35.1792 38.9003C35.1661 39.2415 35.2203 39.582 35.3388 39.9022L39.1608 50.2242C39.2793 50.5445 39.4597 50.8383 39.6917 51.0889C39.9237 51.3394 40.2028 51.5418 40.513 51.6845C40.8233 51.8272 41.1586 51.9074 41.4998 51.9205C41.841 51.9336 42.1815 51.8793 42.5018 51.7609C42.822 51.6424 43.1158 51.462 43.3664 51.2299C43.6169 50.9979 43.8193 50.7188 43.962 50.4086C44.1047 50.0983 44.1849 49.763 44.198 49.4218C44.2111 49.0806 44.1569 48.7401 44.0384 48.4198L40.2164 38.0978Z"
                  fill="white"
                />
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M39 15.6001C39 13.8762 38.3152 12.2229 37.0962 11.0039C35.8772 9.78492 34.2239 9.1001 32.5 9.1001H19.5C17.7761 9.1001 16.1228 9.78492 14.9038 11.0039C13.6848 12.2229 13 13.8762 13 15.6001V19.5911C13.0005 21.1235 13.5424 22.6065 14.53 23.7782C15.5176 24.9499 16.8874 25.735 18.3976 25.9949C20.93 26.4317 23.4641 26.6501 26 26.6501C28.5359 26.6501 31.07 26.4317 33.6024 25.9949C35.1126 25.735 36.4824 24.9499 37.47 23.7782C38.4576 22.6065 38.9995 21.1235 39 19.5911V15.6001ZM18.2 19.5911V15.6001C18.2 15.2553 18.337 14.9247 18.5808 14.6809C18.8246 14.4371 19.1552 14.3001 19.5 14.3001H32.5C32.8448 14.3001 33.1754 14.4371 33.4192 14.6809C33.663 14.9247 33.8 15.2553 33.8 15.6001V19.5911C33.7996 19.8972 33.6911 20.1934 33.4937 20.4274C33.2963 20.6614 33.0227 20.8183 32.721 20.8703C30.4763 21.2568 28.236 21.4501 26 21.4501C23.764 21.4501 21.5237 21.2568 19.279 20.8703C18.9773 20.8183 18.7037 20.6614 18.5063 20.4274C18.3089 20.1934 18.2004 19.8972 18.2 19.5911Z"
                  fill="white"
                />
                <path d="M12.3496 47.45V43.55H39.6522V47.45H12.3496Z" fill="white" />
              </g>
              <defs>
                <clipPath id="clip0_3824_7434">
                  <rect width="52" height="52" fill="white" />
                </clipPath>
              </defs>
            </svg>
          </button>
        </RouterLink>
        <RouterLink to="yellow" class="router_link">
          <button class="yellow">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="52"
              height="52"
              viewBox="0 0 52 52"
              fill="none"
            >
              <g clip-path="url(#clip0_3824_7434)">
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M45.5 13.0001C45.5 10.2418 44.4043 7.59657 42.4539 5.64619C40.5035 3.69581 37.8583 2.6001 35.1 2.6001H16.9C14.1417 2.6001 11.4965 3.69581 9.54609 5.64619C7.59571 7.59657 6.5 10.2418 6.5 13.0001V31.1741C6.50007 33.3936 7.21024 35.555 8.52665 37.342C9.84306 39.129 11.6967 40.448 13.8164 41.1061C17.8689 42.3628 21.9301 42.992 26 42.9937C30.0699 42.9937 34.1311 42.3636 38.1836 41.1035C40.3033 40.4454 42.1569 39.1264 43.4734 37.3394C44.7898 35.5524 45.4999 33.391 45.5 31.1715V13.0001ZM11.7 31.1741V13.0001C11.7 11.621 12.2479 10.2983 13.223 9.32314C14.1982 8.34795 15.5209 7.8001 16.9 7.8001H35.1C36.4791 7.8001 37.8018 8.34795 38.777 9.32314C39.7521 10.2983 40.3 11.621 40.3 13.0001V31.1741C40.3 32.2839 39.9449 33.3645 39.2867 34.258C38.6285 35.1515 37.7017 35.811 36.6418 36.1401C33.1988 37.2275 29.6106 37.785 26 37.7937C22.4623 37.7937 18.915 37.2416 15.3582 36.1375C14.2988 35.8086 13.3723 35.1495 12.7141 34.2565C12.0559 33.3635 11.7006 32.2834 11.7 31.1741Z"
                  fill="white"
                />
                <path
                  d="M20.7996 31.2C20.7996 32.2344 20.3887 33.2264 19.6573 33.9578C18.9259 34.6892 17.9339 35.1 16.8996 35.1C15.8652 35.1 14.8733 34.6892 14.1419 33.9578C13.4105 33.2264 12.9996 32.2344 12.9996 31.2C12.9996 30.1657 13.4105 29.1737 14.1419 28.4423C14.8733 27.7109 15.8652 27.3 16.8996 27.3C17.9339 27.3 18.9259 27.7109 19.6573 28.4423C20.3887 29.1737 20.7996 30.1657 20.7996 31.2ZM38.9996 31.2C38.9996 32.2344 38.5887 33.2264 37.8573 33.9578C37.1259 34.6892 36.1339 35.1 35.0996 35.1C34.0652 35.1 33.0733 34.6892 32.3419 33.9578C31.6105 33.2264 31.1996 32.2344 31.1996 31.2C31.1996 30.1657 31.6105 29.1737 32.3419 28.4423C33.0733 27.7109 34.0652 27.3 35.0996 27.3C36.1339 27.3 37.1259 27.7109 37.8573 28.4423C38.5887 29.1737 38.9996 30.1657 38.9996 31.2ZM11.9102 39.3822C12.0403 39.0633 12.2325 38.7735 12.4757 38.5295C12.7188 38.2854 13.008 38.0922 13.3264 37.9609C13.6448 37.8296 13.9862 37.7629 14.3307 37.7646C14.6751 37.7664 15.0158 37.8366 15.3329 37.9711C15.6499 38.1056 15.9372 38.3018 16.1778 38.5482C16.4184 38.7947 16.6077 39.0865 16.7346 39.4067C16.8615 39.7269 16.9235 40.0692 16.917 40.4136C16.9105 40.758 16.8357 41.0976 16.6968 41.4128L12.8618 50.4478C12.7363 50.7732 12.5466 51.07 12.3041 51.3206C12.0616 51.5712 11.7711 51.7704 11.45 51.9064C11.1289 52.0424 10.7837 52.1124 10.4349 52.1123C10.0862 52.1121 9.74108 52.0419 9.42007 51.9056C9.09907 51.7694 8.80875 51.5699 8.5664 51.3192C8.32405 51.0684 8.13462 50.7715 8.00938 50.446C7.88415 50.1205 7.82566 49.7732 7.83741 49.4247C7.84916 49.0761 7.93091 48.7335 8.07778 48.4172L11.9102 39.3822ZM40.2164 38.0978C40.0979 37.7776 39.9175 37.4838 39.6855 37.2332C39.4535 36.9827 39.1744 36.7803 38.8641 36.6376C38.5539 36.4949 38.2186 36.4147 37.8773 36.4016C37.5361 36.3885 37.1956 36.4428 36.8754 36.5612C36.5551 36.6797 36.2613 36.8601 36.0108 37.0921C35.7602 37.3242 35.5578 37.6033 35.4151 37.9135C35.2725 38.2237 35.1923 38.5591 35.1792 38.9003C35.1661 39.2415 35.2203 39.582 35.3388 39.9022L39.1608 50.2242C39.2793 50.5445 39.4597 50.8383 39.6917 51.0889C39.9237 51.3394 40.2028 51.5418 40.513 51.6845C40.8233 51.8272 41.1586 51.9074 41.4998 51.9205C41.841 51.9336 42.1815 51.8793 42.5018 51.7609C42.822 51.6424 43.1158 51.462 43.3664 51.2299C43.6169 50.9979 43.8193 50.7188 43.962 50.4086C44.1047 50.0983 44.1849 49.763 44.198 49.4218C44.2111 49.0806 44.1569 48.7401 44.0384 48.4198L40.2164 38.0978Z"
                  fill="white"
                />
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M39 15.6001C39 13.8762 38.3152 12.2229 37.0962 11.0039C35.8772 9.78492 34.2239 9.1001 32.5 9.1001H19.5C17.7761 9.1001 16.1228 9.78492 14.9038 11.0039C13.6848 12.2229 13 13.8762 13 15.6001V19.5911C13.0005 21.1235 13.5424 22.6065 14.53 23.7782C15.5176 24.9499 16.8874 25.735 18.3976 25.9949C20.93 26.4317 23.4641 26.6501 26 26.6501C28.5359 26.6501 31.07 26.4317 33.6024 25.9949C35.1126 25.735 36.4824 24.9499 37.47 23.7782C38.4576 22.6065 38.9995 21.1235 39 19.5911V15.6001ZM18.2 19.5911V15.6001C18.2 15.2553 18.337 14.9247 18.5808 14.6809C18.8246 14.4371 19.1552 14.3001 19.5 14.3001H32.5C32.8448 14.3001 33.1754 14.4371 33.4192 14.6809C33.663 14.9247 33.8 15.2553 33.8 15.6001V19.5911C33.7996 19.8972 33.6911 20.1934 33.4937 20.4274C33.2963 20.6614 33.0227 20.8183 32.721 20.8703C30.4763 21.2568 28.236 21.4501 26 21.4501C23.764 21.4501 21.5237 21.2568 19.279 20.8703C18.9773 20.8183 18.7037 20.6614 18.5063 20.4274C18.3089 20.1934 18.2004 19.8972 18.2 19.5911Z"
                  fill="white"
                />
                <path d="M12.3496 47.45V43.55H39.6522V47.45H12.3496Z" fill="white" />
              </g>
              <defs>
                <clipPath id="clip0_3824_7434">
                  <rect width="52" height="52" fill="white" />
                </clipPath>
              </defs>
            </svg>
          </button>
        </RouterLink>
        <RouterLink to="brown" class="router_link">
          <button class="brown">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="52"
              height="52"
              viewBox="0 0 52 52"
              fill="none"
            >
              <g clip-path="url(#clip0_3824_7434)">
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M45.5 13.0001C45.5 10.2418 44.4043 7.59657 42.4539 5.64619C40.5035 3.69581 37.8583 2.6001 35.1 2.6001H16.9C14.1417 2.6001 11.4965 3.69581 9.54609 5.64619C7.59571 7.59657 6.5 10.2418 6.5 13.0001V31.1741C6.50007 33.3936 7.21024 35.555 8.52665 37.342C9.84306 39.129 11.6967 40.448 13.8164 41.1061C17.8689 42.3628 21.9301 42.992 26 42.9937C30.0699 42.9937 34.1311 42.3636 38.1836 41.1035C40.3033 40.4454 42.1569 39.1264 43.4734 37.3394C44.7898 35.5524 45.4999 33.391 45.5 31.1715V13.0001ZM11.7 31.1741V13.0001C11.7 11.621 12.2479 10.2983 13.223 9.32314C14.1982 8.34795 15.5209 7.8001 16.9 7.8001H35.1C36.4791 7.8001 37.8018 8.34795 38.777 9.32314C39.7521 10.2983 40.3 11.621 40.3 13.0001V31.1741C40.3 32.2839 39.9449 33.3645 39.2867 34.258C38.6285 35.1515 37.7017 35.811 36.6418 36.1401C33.1988 37.2275 29.6106 37.785 26 37.7937C22.4623 37.7937 18.915 37.2416 15.3582 36.1375C14.2988 35.8086 13.3723 35.1495 12.7141 34.2565C12.0559 33.3635 11.7006 32.2834 11.7 31.1741Z"
                  fill="white"
                />
                <path
                  d="M20.7996 31.2C20.7996 32.2344 20.3887 33.2264 19.6573 33.9578C18.9259 34.6892 17.9339 35.1 16.8996 35.1C15.8652 35.1 14.8733 34.6892 14.1419 33.9578C13.4105 33.2264 12.9996 32.2344 12.9996 31.2C12.9996 30.1657 13.4105 29.1737 14.1419 28.4423C14.8733 27.7109 15.8652 27.3 16.8996 27.3C17.9339 27.3 18.9259 27.7109 19.6573 28.4423C20.3887 29.1737 20.7996 30.1657 20.7996 31.2ZM38.9996 31.2C38.9996 32.2344 38.5887 33.2264 37.8573 33.9578C37.1259 34.6892 36.1339 35.1 35.0996 35.1C34.0652 35.1 33.0733 34.6892 32.3419 33.9578C31.6105 33.2264 31.1996 32.2344 31.1996 31.2C31.1996 30.1657 31.6105 29.1737 32.3419 28.4423C33.0733 27.7109 34.0652 27.3 35.0996 27.3C36.1339 27.3 37.1259 27.7109 37.8573 28.4423C38.5887 29.1737 38.9996 30.1657 38.9996 31.2ZM11.9102 39.3822C12.0403 39.0633 12.2325 38.7735 12.4757 38.5295C12.7188 38.2854 13.008 38.0922 13.3264 37.9609C13.6448 37.8296 13.9862 37.7629 14.3307 37.7646C14.6751 37.7664 15.0158 37.8366 15.3329 37.9711C15.6499 38.1056 15.9372 38.3018 16.1778 38.5482C16.4184 38.7947 16.6077 39.0865 16.7346 39.4067C16.8615 39.7269 16.9235 40.0692 16.917 40.4136C16.9105 40.758 16.8357 41.0976 16.6968 41.4128L12.8618 50.4478C12.7363 50.7732 12.5466 51.07 12.3041 51.3206C12.0616 51.5712 11.7711 51.7704 11.45 51.9064C11.1289 52.0424 10.7837 52.1124 10.4349 52.1123C10.0862 52.1121 9.74108 52.0419 9.42007 51.9056C9.09907 51.7694 8.80875 51.5699 8.5664 51.3192C8.32405 51.0684 8.13462 50.7715 8.00938 50.446C7.88415 50.1205 7.82566 49.7732 7.83741 49.4247C7.84916 49.0761 7.93091 48.7335 8.07778 48.4172L11.9102 39.3822ZM40.2164 38.0978C40.0979 37.7776 39.9175 37.4838 39.6855 37.2332C39.4535 36.9827 39.1744 36.7803 38.8641 36.6376C38.5539 36.4949 38.2186 36.4147 37.8773 36.4016C37.5361 36.3885 37.1956 36.4428 36.8754 36.5612C36.5551 36.6797 36.2613 36.8601 36.0108 37.0921C35.7602 37.3242 35.5578 37.6033 35.4151 37.9135C35.2725 38.2237 35.1923 38.5591 35.1792 38.9003C35.1661 39.2415 35.2203 39.582 35.3388 39.9022L39.1608 50.2242C39.2793 50.5445 39.4597 50.8383 39.6917 51.0889C39.9237 51.3394 40.2028 51.5418 40.513 51.6845C40.8233 51.8272 41.1586 51.9074 41.4998 51.9205C41.841 51.9336 42.1815 51.8793 42.5018 51.7609C42.822 51.6424 43.1158 51.462 43.3664 51.2299C43.6169 50.9979 43.8193 50.7188 43.962 50.4086C44.1047 50.0983 44.1849 49.763 44.198 49.4218C44.2111 49.0806 44.1569 48.7401 44.0384 48.4198L40.2164 38.0978Z"
                  fill="white"
                />
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M39 15.6001C39 13.8762 38.3152 12.2229 37.0962 11.0039C35.8772 9.78492 34.2239 9.1001 32.5 9.1001H19.5C17.7761 9.1001 16.1228 9.78492 14.9038 11.0039C13.6848 12.2229 13 13.8762 13 15.6001V19.5911C13.0005 21.1235 13.5424 22.6065 14.53 23.7782C15.5176 24.9499 16.8874 25.735 18.3976 25.9949C20.93 26.4317 23.4641 26.6501 26 26.6501C28.5359 26.6501 31.07 26.4317 33.6024 25.9949C35.1126 25.735 36.4824 24.9499 37.47 23.7782C38.4576 22.6065 38.9995 21.1235 39 19.5911V15.6001ZM18.2 19.5911V15.6001C18.2 15.2553 18.337 14.9247 18.5808 14.6809C18.8246 14.4371 19.1552 14.3001 19.5 14.3001H32.5C32.8448 14.3001 33.1754 14.4371 33.4192 14.6809C33.663 14.9247 33.8 15.2553 33.8 15.6001V19.5911C33.7996 19.8972 33.6911 20.1934 33.4937 20.4274C33.2963 20.6614 33.0227 20.8183 32.721 20.8703C30.4763 21.2568 28.236 21.4501 26 21.4501C23.764 21.4501 21.5237 21.2568 19.279 20.8703C18.9773 20.8183 18.7037 20.6614 18.5063 20.4274C18.3089 20.1934 18.2004 19.8972 18.2 19.5911Z"
                  fill="white"
                />
                <path d="M12.3496 47.45V43.55H39.6522V47.45H12.3496Z" fill="white" />
              </g>
              <defs>
                <clipPath id="clip0_3824_7434">
                  <rect width="52" height="52" fill="white" />
                </clipPath>
              </defs>
            </svg>
          </button>
        </RouterLink>
      </div>

      <PopupMenu v-if="isPopupOpen" @close="isPopupOpen = false" @openModal="openModal" />

      <ModalMenu v-if="isModalOpen" :type="selectedModal" @close="isModalOpen = false" />
    </div>
    <router-view />
  </div>

  <Footer />
</template>
<script>
import { ref, onMounted, onUnmounted, watch } from "vue";
import Navbar_V1 from "@/components/Navbar_V1.vue";
import Footer from "../components/Footer.vue";
import ModalMenu from "../components/Mission/ModalMenu.vue";
import PopupMenu from "../components/Mission/PopupMenu.vue";
import { useUserPoints } from "../js/view/useUserPoints";
export default {
  components: {
    ModalMenu,
    PopupMenu,
    Navbar_V1,
    Footer,
  },

  setup() {
    const ball = ref(null);
    const container = ref(null);
    const section = ref(null);
    const header = ref(null);
    const footer = ref(null);
    const questionSection = ref(null);
    const verticalLine = ref(null);
    const { userPoints } = useUserPoints();
    const isPopupOpen = ref(false);
    const isModalOpen = ref(false);
    const selectedModal = ref("");
    const openModal = (type) => {
      selectedModal.value = type;
      isModalOpen.value = true;
    };
    const closePopupMenu = () => {
      isPopupOpen.value = false;
    };

    const closeModal = () => {
      isModalOpen.value = false;
    };

    const activeStationId = ref(null);
    const activeQuestionId = ref(null);

    const gap = 50;
    const onScroll = () => {
      if (
        !verticalLine.value ||
        !ball.value ||
        !container.value ||
        !header.value ||
        !footer.value ||
        !questionSection.value ||
        !section.value
      )
        return;
      const scrollTop = window.scrollY;
      const headerHeight = header.value.offsetHeight;
      const headerRect = header.value.getBoundingClientRect();
      const footerRect = footer.value.getBoundingClientRect();
      const questionRect = questionSection.value.getBoundingClientRect();

      const startScroll = headerRect.bottom + scrollTop; // ball 開始滾動的點
      const stopScroll = footerRect.top + scrollTop - 150; // ball 停止滾動的點
      const questionStop = questionRect.top + scrollTop; // section 停止的位置

      // 線
      // 當滾動未達 header 高度的一半時，line 隱藏在 header 底下
      const gapAboveFooter = 20;

      if (scrollY < headerHeight / 2) {
        // 還沒開始畫線，隱藏在 header 底下
        verticalLine.value.style.top = `${headerHeight}px`;
        verticalLine.value.style.height = "0px";
      } else if (scrollY >= headerHeight / 2 && scrollY < headerHeight) {
        // 滾動介於 header 一半到 header 底時，依滾動進度展開 line
        const progress = (scrollY - headerHeight / 2) / (headerHeight / 2);
        let targetHeight = progress * (window.innerHeight - headerHeight);
        // 限制 targetHeight 不會超過 footer 區域：計算 header 底部到 footer 上緣的最大距離
        const maxLineHeight = footerRect.top - gapAboveFooter - headerHeight;
        if (targetHeight > maxLineHeight) {
          targetHeight = maxLineHeight;
        }
        verticalLine.value.style.top = `${headerHeight}px`;
        verticalLine.value.style.height = `${targetHeight}px`;
      } else {
        // 滾動超過 header，線從 viewport 最上方開始
        let newHeight = window.innerHeight;
        // 若 footer 已進入畫面，則限制高度
        if (footerRect.top < window.innerHeight) {
          newHeight = footerRect.top - gapAboveFooter;
        }
        verticalLine.value.style.top = "0px";
        verticalLine.value.style.height = `${newHeight}px`;
      }
      // 球
      if (scrollTop < startScroll) {
        ball.value.style.position = "fixed";
        ball.value.style.top = `${headerRect.bottom}px`;
        ball.value.style.transform = `translateY(0px)`;
      } else if (scrollTop >= startScroll && scrollTop <= stopScroll) {
        ball.value.style.position = "absolute";
        ball.value.style.top = `${startScroll + gap}px`;
        ball.value.style.transform = `translateY(${scrollTop - startScroll}px)`;
      } else {
        ball.value.style.position = "absolute";
        ball.value.style.top = `${stopScroll}px`;
        ball.value.style.transform = `translateY(0px)`;
      }

      // **控制 section：當 section 底部碰到 question-section 時停止移動**
      const sectionRect = section.value.getBoundingClientRect();
      const sectionHeight = sectionRect.height;
      // 當滾動時 section 的底部位置 = (section 的 top + translateY + sectionHeight)
      // 我們希望當這個值大於等於 question-section 的頂部（questionStop）時，停止移動
      if (scrollTop < startScroll) {
        section.value.style.position = "fixed";
        section.value.style.top = `${headerRect.bottom}px`;
        section.value.style.transform = "translateY(0px)";
      } else if (scrollTop < questionStop - sectionHeight) {
        // 正常隨滾動移動
        section.value.style.position = "absolute";
        section.value.style.top = `${startScroll + gap}px`;
        section.value.style.transform = `translateY(${scrollTop - startScroll}px)`;
      } else {
        // 當 section 底部碰到 question-section，固定 section 位置
        section.value.style.position = "absolute";
        section.value.style.top = `${questionStop - sectionHeight}px`;
        section.value.style.transform = "translateY(0px)";
      }
      const lineElements = document.querySelectorAll(".mission-main .line");
      let activeId = null;
      lineElements.forEach((lineEl) => {
        const rect = lineEl.getBoundingClientRect();
        // 例如判斷畫面中間的區域（此處可依需求調整條件）
        if (
          rect.top <= window.innerHeight * 0.5 &&
          rect.bottom >= window.innerHeight * 0.5
        ) {
          // 從 id "item{line.id}" 中取出數字
          activeId = parseInt(lineEl.id.replace("item", ""), 10);
        }
      });
      activeStationId.value = activeId;
      const questionElements = document.querySelectorAll(".question-section");
      let activeQuestion = null;
      questionElements.forEach((qEl) => {
        const rect = qEl.getBoundingClientRect();
        if (
          rect.top <= window.innerHeight * 0.5 &&
          rect.bottom >= window.innerHeight * 0.5
        ) {
          activeQuestion = parseInt(qEl.id.replace("question-item", ""), 10);
        }
      });
      activeQuestionId.value = activeQuestion;
    };
    onMounted(() => {
      questionSection.value = document.querySelector(".question-section");
      // document.addEventListener("click", handleAnchorClick);
      window.addEventListener("scroll", onScroll);

      onScroll();
    });

    onUnmounted(() => {
      window.removeEventListener("scroll", onScroll);
      // document.addEventListener("click", handleAnchorClick);
    });

    return {
      isPopupOpen,
      isModalOpen,
      selectedModal,
      openModal,
      closePopupMenu,
      closeModal,
      ball,
      container,
      header,
      footer,
      questionSection,
      section,
      activeStationId,
      activeQuestionId,
      // handleAnchorClick,
      verticalLine,
      userPoints,
    };
  },
};
</script>
<style lang="scss" scoped>
@import "@/assets/sass/base/_color.scss";
@import "@/assets/sass/base/_font.scss";
@import "@/assets/sass/component/_btn.scss";
@import "@/assets/sass/mixin/_mixin.scss";
@import "@/assets/sass/page/_mission-special.scss";
</style>
